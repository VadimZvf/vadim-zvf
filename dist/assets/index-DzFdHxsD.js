(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();const a={symbolsPerLine:54,linesCount:18,fontSize:40};class g{constructor(e,t){this.onType=this.onType.bind(this),this.onDelete=this.onDelete.bind(this),this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),this.onEnter=this.onEnter.bind(this),this.renderer=e,this.input=t,this.input.subscribeChangeEvent(this.onType),this.input.subscribeBackspaceKeyEvent(this.onDelete),this.input.subscribeFocusEvent(this.onFocus),this.input.subscribeBlurEvent(this.onBlur),this.input.subscribeEnterKeyEvent(this.onEnter),this.commandListeners=[],window.requestAnimationFrame(this.update.bind(this))}renderer;input;commandListeners;static defaultInputArrow=">";static cursorSymbol="█";static cursorBlinkInterval=500;content=[];typedText="";inputArrow=g.defaultInputArrow;isFocused=!1;cursorVisible=!1;subscribeCommand(e){this.commandListeners.push(e)}addContent(e){const t=[];for(let i=0;i<e.length;i++){const s=e[i];s.length>a.symbolsPerLine?(t.push(s.slice(0,a.symbolsPerLine)),e[i]=s.slice(a.symbolsPerLine),i--):t.push(s)}this.content=this.content.concat(t),this.checkLinesCount(),this.updateRenderer()}setInputArrow(e){this.inputArrow=e,this.updateRenderer()}resetInputArrow(){this.inputArrow!==g.defaultInputArrow&&(this.inputArrow=g.defaultInputArrow,this.updateRenderer())}clear(){this.content=Array(17).fill(" "),this.checkLinesCount(),this.updateRenderer()}toggleRainbowEffect(){this.renderer.toggleRainbowEffect()}onType(e){this.typedText.length+e.length+1<=a.symbolsPerLine&&(this.typedText+=e,this.checkLinesCount(),this.updateRenderer())}onDelete(){this.typedText.length>0&&(this.typedText=this.typedText.substring(0,this.typedText.length-1),this.updateRenderer())}onEnter(){const e=this.typedText;this.typedText="",this.updateRenderer();for(const t of this.commandListeners)t(e.toLocaleLowerCase())}onFocus(){this.isFocused=!0,this.updateRenderer()}onBlur(){this.isFocused=!1,this.updateRenderer()}checkLinesCount(){this.content.length>=a.linesCount&&(this.content=this.content.slice(this.content.length-a.linesCount+1))}update(e){this.isFocused&&(this.cursorVisible=Math.floor(e/g.cursorBlinkInterval)%2===0,this.updateRenderer()),window.requestAnimationFrame(this.update.bind(this))}updateRenderer(){const e=this.content.concat([`${this.inputArrow}${this.typedText}${this.cursorVisible?g.cursorSymbol:""}`]);this.renderer.setContent(e)}}class z{constructor(e,t){this.handleCommand=this.handleCommand.bind(this),this.screen=e,this.system=this.createSystem(),this.loadPrograms(t),e.subscribeCommand(this.handleCommand)}screen;system;programs={};programInProgress;systemApiInProgress=null;loadPrograms(e){for(const t of e)this.programs[t.name]=t.program}handleCommand(e=""){const t=e.split(" ");if(this.systemApiInProgress&&this.performSystemApi(),this.programInProgress){this.performCurrentProgram(t);return}const[i,...s]=t;this.runProgram(i,s)}runProgram(e,t){if(e&&this.programs[e]){this.programInProgress=this.programs[e](t,this.system),this.performCurrentProgram(t);return}this.screen.addContent([`Unknown command - ${e}`,'Use "help" to see the list of available commands'])}performCurrentProgram(e){if(!this.programInProgress)return;const t=this.programInProgress.next(e);if(t.done){this.programInProgress=null;return}t.value&&this.applySystemAPI(t.value)}applySystemAPI(e){e&&e.type===b.text&&(this.systemApiInProgress=b.text,e.data&&e.data.arrowText&&this.screen.setInputArrow(e.data.arrowText))}performSystemApi(){this.systemApiInProgress===b.text&&this.screen.resetInputArrow(),this.systemApiInProgress=null}createSystem(){return{addContent:e=>this.screen.addContent(e),toggleRainbowEffect:()=>this.screen.toggleRainbowEffect(),clear:()=>this.screen.clear(),requestText:e=>({type:b.text,data:e}),lockInput(){throw new Error("Not implemented")},unlockInput(){throw new Error("Not implemented")}}}}const b={text:"REQUEST_STRING"};function c(n,e){return{name:n,program:e}}function f(n){const e=document.createElement("a");e.target="_blank",e.href=n,e.click()}function U(n,e){switch(n){case"vk":f("https://vk.com/zainetdinov_vadim");break;case"instagram":f("https://www.instagram.com/zainetdinovvadim");break;case"linkedin":f("https://www.linkedin.com/in/vadim-zaynetdinov-27908417b");break;case"telegram":f("https://t.me/vadimzvf");break;default:e.addContent([`Unknown social name - ${n}`]);break}}const O=c("socials",function*(n,e){const[t]=n;if(t){U(t,e);return}else e.addContent(["I am in social networks:"," - vk"," - instagram"," - linkedin"," - telegram","Enter the name of a social network to open it"]);const i=yield e.requestText({arrowText:"social:"});U(i[0],e)}),X=c("help",function*(n,e){e.addContent(["Available commands:"," - contacts"," - socials"," - about"," - show"," - rainbow"," - race"," - source-code"," - help"," - clear"])}),W=c("contacts",function*(n,e){e.addContent(["email: vadim.zvf@gmail.com","","Do you want to write to me?"]);const t=yield e.requestText({arrowText:"Yes or no (Y/N):"});["Y","y","Yes","yes"].includes(t[0])?f("mailto:vadim.zvf@gmail.com"):e.addContent(["OK :("])});function Y(){const n=new Date("1994-07-14"),e=Date.now()-n.getTime(),t=new Date(e);return Math.abs(t.getUTCFullYear()-1970)}const $=c("about",function*(n,e){e.clear(),e.addContent(["name: Vadim",`age: ${Y()}`,"skills: Frontend","experience:","  May 2023 - now...............Pigment","  April 2020 - May 2023........Yandex","  July 2017 - March 2020.......byndyusoft","  September 2016 - July 2017...bookscriptor","  ... - September 2016.........freelance","","",""])}),K=c("source-code",function*(n,e){f("https://github.com/VadimZvf/vadim-zvf")});function N(n,e){switch(n){case"cat":e.addContent(["██        ██","█ █      █ █","█░ █    █ ░█","█░░ ████ ░░█","█  █    █  █","█          █     ██","█  █    █  █    █  █","█ █ █  █ █ █    █   █","█░░      ░░█     ██  █"," █   ░░   █ ███    █ █","  █      █     █   █ █","   ██████   ██  █  █ █","    █      █    ███  █","    █      █    ██   █","   ███     █    █   █","  █       █     ████","   █████████████"]);break;case"dog":e.addContent([" ███     ███","█░░░█████░░░█","█░██  ░░░██░█"," █ █ █░█░█ █","   █  ░░░█","  █       █","  █  ███  █","  █       █    ██","   █  █  █ █   █░█","    █████  ░█   █░█","       █   ░░█   █ █","       █   ░░░█  █ █","       █ █ █░░░██   █","       █ █ █        █","       █ █ █     █  █","      █  █  █   █   █","      ███████████████"]);break;default:e.addContent(["Unknown name"]);break}}const q=c("show",function*(n,e){const[t]=n;if(t){N(t,e);return}else e.addContent(["I can show you a cat or a dog. who do you want to see?"]);const i=yield e.requestText({arrowText:"name:"});N(i[0],e)}),V=c("clear",function*(n,e){e.clear()}),j=c("rainbow",function*(n,e){e.toggleRainbowEffect()}),J=c("greeting",function*(n,e){e.addContent(["HELLO!","Nice to meet U!","My name is Vadim and this is my petproject","","If U need help, just write command - help"])}),Q=""+new URL("explosion-CySXobLL.wav",import.meta.url).href,Z=""+new URL("speed-FadTC-I9.wav",import.meta.url).href,v=40,M=17,C=11,E=17,T=[" █ ","███"," █ ","█ █"],u=T[0].length,ee=T.length,P=["░░░"],te=P[0].length,ne=P.length,L=["░░░░░░░░░░░░░░","░  YOU FAIL  ░","░ TRY HARDER ░","░░░░░░░░░░░░░░"];function m(n,e,t){const i=e.length,s=e[0].length;for(let r=0;r<n.length;r++)if(!(r<t.y||r>=t.y+i))for(let o=0;o<n[r].length;o++)o<t.x||o>=t.x+s||(n[r][o]=e[r-t.y][o-t.x]);return n}function se(){const n=[];for(let e=0;e<M;e++){const t=[];for(let i=0;i<v;i++)t.push(" ");n.push(t)}return n}function ie(n){for(const e of n)e[0]="░",e[C-1]="░"}const D=[1,4,7],re=8,R=200,oe=30;function G(){const n=Math.floor(Math.random()*D.length);return D[n]}function ae(){const n=[];for(let e=E;e>=0;e-=re)n.push({x:G(),y:e-E});return n}function ce(n){const e=[];for(const t of n)t.y>E?e.push({x:G(),y:-ee}):e.push({x:t.x,y:t.y+1});return e}function he(n){return 1-Math.pow(1-n,3)}function de(n,e){const t=e-n,i=R-oe;return R-i*he(t/1e5)}function le(n,e){for(const t of n)if(Math.abs(t.x-e.x)<te&&Math.abs(t.y-e.y)<ne)return!0;return!1}function H(){return(JSON.parse(window.localStorage.getItem("race"))||{bestScore:0}).bestScore}function ue(n){n>H()&&window.localStorage.setItem("race",JSON.stringify({bestScore:n}))}const ge=c("race",function*(n,e){const t=new Audio(Q);t.volume=.5;const i=new Audio(Z);i.volume=.3;const s={x:0,y:0};let r;function o(){const d=H();s.x=Math.round(C/2-u/2),s.y=E-T.length;const w=Date.now();let l=ae(),_=Date.now(),y=0,A=R;function k(){const S=Date.now(),h=se();if(ie(h),S>=_+A){if(l=ce(l),_=S,y+=1,le(l,s)){m(h,L,{x:Math.round(v/2-L[0].length/2),y:Math.round(M/2-L.length/2)}),t.play(),ue(y),e.addContent(h.map(p=>p.join("")));return}y%8===0&&i.play()}A=de(w,S);for(const p of l)m(h,P,p);m(h,T,s),m(h,["best score:"+d],{x:v-25,y:0}),m(h,["score:"+y],{x:v-25,y:1}),m(h,["speed:"+Math.floor(R-A)],{x:v-25,y:3}),e.addContent(h.map(p=>p.join(""))),r=window.requestAnimationFrame(k)}r=window.requestAnimationFrame(k)}function x(d){d.key==="ArrowLeft"&&s.x>1&&(s.x=s.x-u),d.key==="ArrowRight"&&s.x<C-u-1&&(s.x=s.x+u)}function I(d){const w=window.innerWidth,l=d.touches[0].clientX;l/w<.45&&s.x>1&&(s.x=s.x-u),l/w>=.55&&s.x<C-u-1&&(s.x=s.x+u)}for(document.addEventListener("keydown",x),document.addEventListener("touchstart",I),o();;){const[d]=yield e.requestText({arrowText:"type q - for exit, r - for retry:"});if(e.clear(),window.cancelAnimationFrame(r),["R","r","retry","Retry"].includes(d))o();else{document.removeEventListener("keydown",x),document.removeEventListener("touchstart",I);return}}}),me=c("ls",function*(n,e){e.addContent(["No files here"])}),fe=c("pwd",function*(n,e){e.addContent(["/"])}),pe=c("mkdir",function*(n,e){e.addContent(["Permission denied"])}),ve=c("cd",function*(n,e){e.addContent(["Permission denied"])}),xe=`precision highp float;
uniform float uShowRainbow;
uniform sampler2D uScreenTexture;
uniform float time;
varying vec2 v_uv;


// ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
// ┃       Rainbow effect       ┃
// ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
vec4 rainbow(vec2 uv) {
    vec3 color = 0.5 + 0.5 * cos(time / 10.0 + uv.xyx + vec3(0,2,4));

    return uShowRainbow == 1.0 ? vec4(color, 1.0) : vec4(1.0);
}

// ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
// ┃       Curved effect        ┃
// ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
// Takes coordinates of a pixel and returns new coordinates with applied curvature
// of the simulated screen
vec2 getCurvedScreenUv(vec2 uv) {
    vec2 intensity = vec2(
        0.04,
        0.01
    );

    // Simple stretch logic
    vec2 coords = (uv - 0.5) * 2.0;        
        
    vec2 coordsOffset = vec2(
        (1.0 - coords.y * coords.y) * intensity.y * (coords.x), 
        (1.0 - coords.x * coords.x) * intensity.x * (coords.y)
    );

    return uv - coordsOffset;
}

vec3 applyPadding(vec2 uv) {
    vec2 padding = vec2(0.1, 0.1);

    vec2 scale = (0.5 - padding) / 0.5;
    vec2 centeredUv = uv - 0.5;
    vec2 scaledCenteredUv = centeredUv / scale;
    vec2 finalUv = scaledCenteredUv + 0.5;

    return vec3(
        finalUv,
        // alpha to hide pixels outside of the screen
        step(0.0, finalUv.x) * step(0.0, finalUv.y) * step(finalUv.x, 1.0) * step(finalUv.y, 1.0)
    );
}

void main(void) {
    vec2 curvedUv = getCurvedScreenUv(v_uv);
    vec3 uv = applyPadding(curvedUv);

    vec4 textColor = texture2D(uScreenTexture, uv.xy);

    textColor *= rainbow(uv.xy);

    gl_FragColor = textColor * uv.z;
}
`,we=`precision mediump float;
attribute vec2 a_position;

varying vec2 v_uv;

void main() {
    v_uv = a_position * 0.5 + 0.5;

    gl_Position = vec4(a_position, 0.0, 1.0);
}`,F="monospace",B="#fff";class ye{constructor(e){const t=document.createElement("canvas");t.style.position="absolute",t.style.top="-100%",t.style.left="-100%",t.style.opacity="0",document.body.appendChild(t),this.screenCanvasCtx=t.getContext("2d");const i=document.createElement("canvas");document.body.appendChild(i),this.renderCanvas=i,this.setSize(e.size)}renderCanvas;renderProgram;gl;screenTexture;screenCanvasCtx;screenLineHeight;isRainbowEffectEnabled=!1;render(e){this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.screenTexture),this.gl.uniform1i(this.gl.getUniformLocation(this.renderProgram,"uScreenTexture"),0),this.gl.uniform1f(this.gl.getUniformLocation(this.renderProgram,"uShowRainbow"),this.isRainbowEffectEnabled?1:0),this.gl.uniform1f(this.gl.getUniformLocation(this.renderProgram,"time"),e/100),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}setSize(e){const t=Math.min(e.width,e.height);this.renderCanvas.width=t,this.renderCanvas.height=t}createScreen(){this.screenCanvasCtx.font=`${a.fontSize}px ${F}`,this.screenCanvasCtx.fillStyle=B,this.screenCanvasCtx.textBaseline="top";const e=this.screenCanvasCtx.measureText("M"),t=e.width;this.screenLineHeight=e.fontBoundingBoxDescent;const i=t*a.symbolsPerLine,s=this.screenLineHeight*a.linesCount;this.screenCanvasCtx.canvas.width=i,this.screenCanvasCtx.canvas.height=s,this.gl=this.renderCanvas.getContext("webgl");const r=new Float32Array([-1,-1,1,-1,-1,1,1,1]);this.renderProgram=this.gl.createProgram(),this.gl.attachShader(this.renderProgram,this.createShader(this.gl.VERTEX_SHADER,we)),this.gl.attachShader(this.renderProgram,this.createShader(this.gl.FRAGMENT_SHADER,xe)),this.gl.linkProgram(this.renderProgram),this.gl.useProgram(this.renderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.gl.createBuffer()),this.gl.bufferData(this.gl.ARRAY_BUFFER,r,this.gl.STATIC_DRAW);const o=this.gl.getAttribLocation(this.renderProgram,"a_position");this.gl.enableVertexAttribArray(o),this.gl.vertexAttribPointer(o,2,this.gl.FLOAT,!1,0,0);const x=this.screenCanvasCtx.canvas;this.screenTexture=this.createTexture(x)}setLines(e){e.length>a.linesCount&&console.warn(`Too many lines - ${e.length}. Maximum available - ${a.linesCount}`),this.screenCanvasCtx.clearRect(0,0,this.screenCanvasCtx.canvas.width,this.screenCanvasCtx.canvas.height),this.screenCanvasCtx.rect(0,0,this.screenCanvasCtx.canvas.width,this.screenCanvasCtx.canvas.height),this.screenCanvasCtx.fillStyle="black",this.screenCanvasCtx.fill(),this.screenCanvasCtx.font=`${a.fontSize}px ${F}`,this.screenCanvasCtx.fillStyle=B,this.screenCanvasCtx.textBaseline="top";const t=e.slice(0,a.linesCount);for(let i=0;i<t.length;i++){let s=e[i];s.length>a.symbolsPerLine&&console.warn(`Too many symbols - ${s.length}. Line can contain maximum - ${a.symbolsPerLine}`),this.screenCanvasCtx.fillText(s,0,this.screenLineHeight*i)}this.gl.bindTexture(this.gl.TEXTURE_2D,this.screenTexture),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.screenCanvasCtx.canvas)}toggleRainbowEffect(){this.isRainbowEffectEnabled=!this.isRainbowEffectEnabled}createTexture(e){this.gl.activeTexture(this.gl.TEXTURE0);let t=this.gl.createTexture();return this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e),t}createShader(e,t){const i=this.gl.createShader(e);return this.gl.shaderSource(i,t),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)||console.error(this.gl.getShaderInfoLog(i)),i}}class be{constructor(){this.render=this.render.bind(this),this.handleResize=this.handleResize.bind(this);const e={width:window.innerWidth,height:window.innerHeight};this.webGLRenderer=new ye({size:e}),this.webGLRenderer.createScreen(),this.init()}webGLRenderer;init(){window.addEventListener("resize",this.handleResize),this.render(Date.now())}render(e){this.webGLRenderer.render(e),window.requestAnimationFrame(this.render)}handleResize(){const e={width:window.innerWidth,height:window.innerHeight};this.webGLRenderer.setSize(e)}setContent(e){this.webGLRenderer.setLines(e)}toggleRainbowEffect(){this.webGLRenderer.toggleRainbowEffect()}}const Ce=/Android/i.test(navigator.userAgent);class Ee{constructor(){this.textareaNode=document.createElement("textarea"),this.textareaNode.style.position="absolute",this.textareaNode.style.top="50%",this.textareaNode.style.left="-999px",this.textareaNode.style.zIndex="-9999",this.textareaNode.style.fontSize="99px",this.textareaNode.style.opacity="0",document.body.appendChild(this.textareaNode),this.subscribeEvents()}textareaNode;subscribeEvents(){document.addEventListener("click",()=>{this.textareaNode.focus()})}subscribeChangeEvent(e){Ce?document.addEventListener("input",t=>{const i=t.data;i&&e(i),this.textareaNode.value=""}):this.textareaNode.addEventListener("keydown",t=>{t.key&&t.key.length===1&&(e(t.key),this.textareaNode.value="")})}subscribeBackspaceKeyEvent(e){this.textareaNode.addEventListener("keydown",t=>{t.key==="Backspace"&&e(),this.textareaNode.value=""})}subscribeEnterKeyEvent(e){this.textareaNode.addEventListener("keyup",t=>{t.key==="Enter"&&e(),this.textareaNode.value=""})}subscribeFocusEvent(e){this.textareaNode.addEventListener("focus",()=>{e()})}subscribeBlurEvent(e){this.textareaNode.addEventListener("blur",()=>{e()})}}const Te=[O,X,W,$,K,q,V,j,J,ge,me,fe,pe,ve];function Re(){const n=new g(new be,new Ee);new z(n,Te).runProgram("greeting",[])}Re();
